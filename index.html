<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>My Diff Tool - v0.0.1</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/diff2html.css">
  <style>
    textarea {
        width: 100%;
        height: 320px;
      }
    </style>
</head>

<body>
  <div class='container-fluid'>
    <div class="row">
      <div class="col-sm">
        <h2>My Diff Tool</h2>
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        <textarea width="100%" id="left"></textarea>
      </div>
      <div class="col-sm">
        <textarea width="100%" id="right"></textarea>
      </div>
    </div>
    <div class="row">
      <div class="col-sm text-center">
        <button type="button" class="btn btn-primary btn-block" id="compare" style="margin-bottom: 10px;">Compare</button>
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        <div id="display">
        </div>
      </div>
    </div>
    <div>
      <script>
        // You can also require other files to run in this process
        require('./renderer.js')
      </script>
      <script>
        var $ = require('jquery');
        
        $(document).ready(() => {
          console.log('loaded!')

          $('#left').val(localStorage.getItem('left')||'');
          $('#right').val(localStorage.getItem('right')||'');

          $("#compare").click(function () {
            var JsDiff = require('diff');
            var left = $("#left").val()
            var right = $("#right").val();

            localStorage.setItem('left', left);
            localStorage.setItem('right', right);

            console.log('left:' + left.length + 'right:' + right.length);
            $("#display").html("");

            var unitedDiff = JsDiff.createPatch('index.html', left, right, 'left', 'right', { context: 999 });
            console.log(unitedDiff)

            let diff2html = require("diff2html").Diff2Html
            var diffHtml = diff2html.getPrettyHtml(
              unitedDiff,
              { inputFormat: 'diff', showFiles: false, matching: 'lines', outputFormat: 'side-by-side' }
            );
            $("#display").html(diffHtml);
          });
        });
      </script>
</body>
</html>